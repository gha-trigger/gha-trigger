"use strict";(self.webpackChunkgha_trigger=self.webpackChunkgha_trigger||[]).push([[162],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>g});var a=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,i=function(e,t){if(null==e)return{};var r,a,i={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var p=a.createContext({}),s=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,i=e.mdxType,n=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=s(r),g=i,k=m["".concat(p,".").concat(g)]||m[g]||c[g]||n;return r?a.createElement(k,o(o({ref:t},u),{},{components:r})):a.createElement(k,o({ref:t},u))}));function g(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var n=r.length,o=new Array(n);o[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var s=2;s<n;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},9390:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>n,metadata:()=>l,toc:()=>s});var a=r(7462),i=(r(7294),r(3905));const n={sidebar_position:100},o="Getting Started",l={unversionedId:"getting-started",id:"getting-started",title:"Getting Started",description:"In the Getting Started, you can set up gha-trigger and experience CI with gha-trigger.",source:"@site/docs/getting-started.md",sourceDirName:".",slug:"/getting-started",permalink:"/gha-trigger/getting-started",draft:!1,editUrl:"https://github.com/suzuki-shunsuke/gha-trigger-docs/edit/main/docs/getting-started.md",tags:[],version:"current",sidebarPosition:100,frontMatter:{sidebar_position:100},sidebar:"tutorialSidebar",previous:{title:"gha-trigger",permalink:"/gha-trigger/"},next:{title:"Configuration",permalink:"/gha-trigger/config/"}},p={},s=[{value:"Requirement",id:"requirement",level:2},{value:"Steps",id:"steps",level:2},{value:"Create GitHub Repositories from template repositories",id:"create-github-repositories-from-template-repositories",level:3},{value:"Create Webhook Secret",id:"create-webhook-secret",level:3},{value:"Create GitHub App(s)",id:"create-github-apps",level:3},{value:"1. Receive webhook and trigger GitHub Actions Workflow",id:"1-receive-webhook-and-trigger-github-actions-workflow",level:4},{value:"2. Receive webhook and trigger GitHub Actions Workflow",id:"2-receive-webhook-and-trigger-github-actions-workflow",level:4},{value:"Set up Terraform Configuration",id:"set-up-terraform-configuration",level:3},{value:"Apply Terraform",id:"apply-terraform",level:3},{value:"Try",id:"try",level:3},{value:"Clean up",id:"clean-up",level:2}],u={toc:s};function c(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"getting-started"},"Getting Started"),(0,i.kt)("p",null,"In the Getting Started, you can set up gha-trigger and experience CI with gha-trigger."),(0,i.kt)("h2",{id:"requirement"},"Requirement"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Git"),(0,i.kt)("li",{parentName:"ul"},"Terraform"),(0,i.kt)("li",{parentName:"ul"},"GitHub Account"),(0,i.kt)("li",{parentName:"ul"},"AWS Account")),(0,i.kt)("h2",{id:"steps"},"Steps"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create GitHub Repositories from template repositories"),(0,i.kt)("li",{parentName:"ol"},"Create Webhook Secret"),(0,i.kt)("li",{parentName:"ol"},"Create GitHub App(s)"),(0,i.kt)("li",{parentName:"ol"},"Set up Terraform Configuration"),(0,i.kt)("li",{parentName:"ol"},"Apply Terraform"),(0,i.kt)("li",{parentName:"ol"},"Try to run CI"),(0,i.kt)("li",{parentName:"ol"},"Clean up")),(0,i.kt)("h3",{id:"create-github-repositories-from-template-repositories"},"Create GitHub Repositories from template repositories"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Main Repository:"),(0,i.kt)("li",{parentName:"ul"},"CI Repository:")),(0,i.kt)("h3",{id:"create-webhook-secret"},"Create Webhook Secret"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks"},"https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks"))),(0,i.kt)("h3",{id:"create-github-apps"},"Create GitHub App(s)"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://docs.github.com/en/developers/apps/building-github-apps/creating-a-github-app"},"https://docs.github.com/en/developers/apps/building-github-apps/creating-a-github-app"))),(0,i.kt)("p",null,"You have to create GitHub App for two purposes."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Receive webhook and trigger GitHub Actions Workflow"),(0,i.kt)("li",{parentName:"ol"},"Access Main Repository in CI of CI Repository")),(0,i.kt)("p",null,"You can use one GitHub App for the above purposes or can create two GitHub Apps for each purpose."),(0,i.kt)("p",null,"You have to install GitHub App in Main Repository and CI Repository.\nYou can either use the same GitHub App or create GitHub Apps per repository."),(0,i.kt)("p",null,"In this Getting Started, let's use the same GitHub App for simplicity."),(0,i.kt)("h4",{id:"1-receive-webhook-and-trigger-github-actions-workflow"},"1. Receive webhook and trigger GitHub Actions Workflow"),(0,i.kt)("p",null,"The minimum setting of GitHub App (1)."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Webhook: Active"),(0,i.kt)("li",{parentName:"ul"},"Permissions",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Actions: Read and write"),(0,i.kt)("li",{parentName:"ul"},"Issues: Read-only"),(0,i.kt)("li",{parentName:"ul"},"Pull requests: Read and write"))),(0,i.kt)("li",{parentName:"ul"},"Install this App in both Main Repository and CI Repository")),(0,i.kt)("h4",{id:"2-receive-webhook-and-trigger-github-actions-workflow"},"2. Receive webhook and trigger GitHub Actions Workflow"),(0,i.kt)("p",null,"The minimum setting of GitHub App (2)."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Webhook: Inactive"),(0,i.kt)("li",{parentName:"ul"},"Permissions",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Commit statuses: Read and write"),(0,i.kt)("li",{parentName:"ul"},"Contents: Read"))),(0,i.kt)("li",{parentName:"ul"},"Install this App in both Main Repository and CI Repository"),(0,i.kt)("li",{parentName:"ul"},"Register GitHub App ID and Private Key as CI Repository's GitHub Secrets")),(0,i.kt)("h3",{id:"set-up-terraform-configuration"},"Set up Terraform Configuration"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ git clone https://github.com/suzuki-shunsuke/gha-trigger\n$ cd gha-trigger/terraform\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/suzuki-shunsuke/gha-trigger/releases"},"Download a zip file from Release page")," on this directory."),(0,i.kt)("p",null,"Create ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yaml"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"secret.yaml"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"terraform.tfvars")," from templates."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ cp config.yaml.tmpl config.yaml\n$ vi config.yaml\n\n$ cp secret.yaml.tmpl secret.yaml\n$ vi secret.yaml\n\n$ cp terraform.tfvars.tmpl terraform.tfvars\n$ vi terraform.tfvars\n")),(0,i.kt)("h3",{id:"apply-terraform"},"Apply Terraform"),(0,i.kt)("p",null,"Create resources."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ terraform apply [-refresh=false]\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"-refresh=false")," is useful to make terraform commands fast."),(0,i.kt)("h3",{id:"try"},"Try"),(0,i.kt)("p",null,"Create a pull request to source repository to test CI."),(0,i.kt)("h2",{id:"clean-up"},"Clean up"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ terraform destroy\n")))}c.isMDXComponent=!0}}]);